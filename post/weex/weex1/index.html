<!DOCTYPE html>
<html lang="en" data-theme=""><head>

    <title> Ermao | weex(一)环境搭建&#43;iOS现有项目集成 </title>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <meta charset="utf-8"><meta name="generator" content="Hugo 0.82.0" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <meta name="description" content="iOS developer/Python/Speech synthesis
Welcome to my site.
Go to &#34; About me&#34; if you want to know more details.
">
    
    <link rel="stylesheet"
          href="/css/style.min.12394ad1dd77abc5f2b8ac9fff89a6f77f11f1db9126284cdea41236936f5c56.css"
          integrity="sha256-EjlK0d13q8XyuKyf/4mm938R8duRJihM3qQSNpNvXFY="
          crossorigin="anonymous"
          type="text/css">
    
    <link rel="stylesheet"
        href="/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css"
        integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS&#43;yuWSR4="
        crossorigin="anonymous"
        type="text/css">
    
    <link rel="stylesheet" 
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" 
    integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" 
    crossorigin="anonymous" />

    
    <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">

    <link rel="canonical" href="/post/weex/weex1/">

    
    
    
    
    <script type="text/javascript"
            src="/js/anatole-header.min.0c05c0a90d28c968a1cad4fb31abd0b8e1264e788ccefed022ae1d3b6f627514.js"
            integrity="sha256-DAXAqQ0oyWihytT7MavQuOEmTniMzv7QIq4dO29idRQ="
            crossorigin="anonymous"></script>

    
        
        
        <script type="text/javascript"
                src="/js/anatole-theme-switcher.min.47918423907d577c1f04c2fd28730186eca486fb18e52fc882c3c7ad5f2540b1.js"
                integrity="sha256-R5GEI5B9V3wfBML9KHMBhuykhvsY5S/IgsPHrV8lQLE="
                crossorigin="anonymous"></script>
    
    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://fuCking-Life.github.io/images/site-feature-image.png"/>

<meta name="twitter:title" content="weex(一)环境搭建&#43;iOS现有项目集成"/>
<meta name="twitter:description" content="weex第一篇主要关于环境搭建"/>


    

</head>
<body><div class="sidebar animated fadeInDown ">
    <div class="logo-title">
        <div class="title">
            <img src="/images/profile.jpg" alt="profile picture">
            <h3 title=""><a href="/">Hey. I&#39;m Ermao.</a></h3>
            <div class="description">
                <p>iOS developer/Python/Speech synthesis<br>Welcome to my site.<br>Go to " About me" if you want to know more details.<br></p>
            </div>
        </div>
    </div>
    <ul class="social-links">
        
            <li>
                <a href="https://de.linkedin.com/" rel="me" aria-label="Linkedin">
                    <i class="fab fa-linkedin fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
            <li>
                <a href="https://github.com/fuCking-Life/" rel="me" aria-label="GitHub">
                    <i class="fab fa-github fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
            <li>
                <a href="mailto:464514962@qq.com" rel="me" aria-label="e-mail">
                    <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
                </a>
            </li>
        
    </ul>
    <div class="footer">
        <div class="by_farbox">&copy; Ermao  2022 </div>
    </div>
</div>
<div class="main">
    <div class="page-top  animated fadeInDown ">
    <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
    </a>
    <ul class="nav" id="navMenu">
        
        
            
            <li><a 
                   href="/"
                        
                   title="">Home</a></li>
        
            
            <li><a 
                   href="/post/"
                        
                   title="">Posts</a></li>
        
            
            <li><a 
                   href="/books/"
                        
                   title="">Books</a></li>
        
            
            <li><a 
                   href="/life/"
                        
                   title="">Life</a></li>
        
            
            <li><a 
                   href="/about/"
                        
                   title="">About me</a></li>
        
        
        
            <li class="theme-switch-item">
                <a class="theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a>
            </li>
        
    </ul>
</div>

    <div class="autopagerize_page_element">
        <div class="content">
    <div class="post  animated fadeInDown ">
        <div class="post-content">
            
            <div class="post-title">
                <h3>weex(一)环境搭建&#43;iOS现有项目集成</h3>
                
                    <div class="info">
                        <em class="fas fa-calendar-day"></em>
                        <span class="date"> Thu, May 17, 2018 
                                           </span>
                        <em class="fas fa-stopwatch"></em>
                        <span class="reading-time">300 Words|Read in about 2 Min|Total Amount of Reading <span id="busuanzi_value_page_pv"></span>Times</span>
                    </div>
                

            </div>

            <p>weex第一篇主要关于环境搭建</p>
<h2 id="一-环境搭建">一. 环境搭建</h2>
<p>以下搭建过程来源<a href="http://weex.apache.org/cn/guide/">WEEX官网</a>。做了简单的提炼和总结。以及一些坑点。</p>
<p>如果只想去试试看的话，<a href="http://dotwe.org/vue">这里有个在线的编辑器可以使用</a>，可以用这个尝试一下。</p>
<h3 id="11-安装homebrew--nodejs">1.1 安装homebrew + Node.js</h3>
<p>这一部分可移步<a href="https://www.jianshu.com/p/17fe9a6bc758">First：React native搭建记录</a>。安装和配置是完全一样的。</p>
<h3 id="12-官方weex-toolkit脚手架的安装">1.2 官方weex-toolkit脚手架的安装</h3>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">在终端执行npm install -g weex-toolkit。
/*******这里留个坑，等以后来填。*******/
安装好后这里有个奇怪的地方：
官网说weex1.0.8之后新增了npm5规范的版本依赖，我安装结束之后，在中端输入weex告诉我：
It looks like you&#39;re using npm 5 which was recently released.
Weex Toolkit doesn&#39;t work well with npm 5 yet, unfortunately.
We recommend using npm 4 until some bugs are resolved.
To install npm 4, you can just run `npm i npm@4 -g` or use `n` to manage your npm version with node.
大致意思就是说，weex-toolkit在5的支持上并不怎么好。强烈建议我使用npm4。那么问题来了，
我到底用npm4还是5，总感觉是不是官网文档没有更新。有点奇怪。
/*******这里留个坑，等以后来填。*******/
</code></pre></div><h2 id="二-创建项目">二. 创建项目</h2>
<ul>
<li>1.打开终端，cd到你要创建项目的目录</li>
<li>2.执行weex create HelloWorld</li>
<li>3.执行完成后会有一个简单的设置过程</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-txt" data-lang="txt">? Project name （这里填你的项目名称，不要有大写，会出粗）
? Project description （项目描述）
? Author （作者）
? Select weex web render（这里我选择的最新，你也可以选择很多人用的那个）
? Babel compiler （babel版本，选择建议的就好）
? Use vue-router to manage your view router? (not recommended)（选择建议的就好）
? Use ESLint to lint your code? （代码检查器，这个YES）
? Pick an ESLint preset Airbnb（代码的检查规则，用airbnb的或者标准模式）
? Set up unit tests Yes（是否设置单元测试）
? Should we run `npm install` for you after the project has been created? (recom
mended) （用npm还是yarn，还是看自己）

/*****这些设置结束后需要一个漫长的等待过程，可以去喝杯茶*****/
</code></pre></div><ul>
<li>4.执行npm install</li>
<li>5.npm run dev &amp; npm run serve</li>
<li>6.enjoy coding</li>
</ul>
<h2 id="三-集成weex到现有应用以空应用作为demo">三. 集成Weex到现有应用（以空应用作为demo）</h2>
<h4 id="31-集成">3.1 集成</h4>
<p><strong>默认开发环境有pod</strong></p>
<ul>
<li>1.创建个应用</li>
<li>2.在根目录创建Podfile，并在其中复制：pod &lsquo;WeexSDK&rsquo;,&lsquo;0.18.0&rsquo;。这个版本号。。要自己去查一下。最好是用最新的，要不然会出问题。完成之后pod install即可。</li>
</ul>
<h4 id="32-运行iphone-真机">3.2 运行（iPhone 真机）</h4>
<ul>
<li>1.找个js文件，放入项目根目录。</li>
<li>2.在delegate中导入头文件#import &lt;WeexSDK/WeexSDK.h&gt;,初始化weexsdk</li>
<li>3.集成相关代码</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-objc" data-lang="objc"><span class="err">在</span><span class="n">delegate</span><span class="p">.</span><span class="n">m的didFinishLaunchingWithOptions中复制一下代码</span><span class="err">：</span>
    <span class="p">[</span><span class="n">WXAppConfiguration</span> <span class="nl">setAppGroup</span><span class="p">:</span><span class="s">@&#34;XXX&#34;</span><span class="p">];</span>
    <span class="p">[</span><span class="n">WXAppConfiguration</span> <span class="nl">setAppName</span><span class="p">:</span><span class="s">@&#34;xxx&#34;</span><span class="p">];</span>
    <span class="p">[</span><span class="n">WXAppConfiguration</span> <span class="nl">setAppVersion</span><span class="p">:</span><span class="s">@&#34;xxx&#34;</span><span class="p">];</span>
    <span class="c1">//init sdk environment
</span><span class="c1"></span>    <span class="p">[</span><span class="n">WXSDKEngine</span> <span class="n">initSDKEnvironment</span><span class="p">];</span>
    <span class="p">[</span><span class="n">WXLog</span> <span class="nl">setLogLevel</span><span class="p">:</span> <span class="n">WXLogLevelError</span><span class="p">];</span>
<span class="c1">//上面xxx的位置自己修改即可
</span></code></pre></div><ul>
<li>4.在viewcontroller中，引入头文件#import &lt;WeexSDK/WeexSDK.h&gt;，并在viewdidload中引入以下代码。</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-objc" data-lang="objc"><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">initWeexView</span><span class="p">{</span>
    <span class="n">_instance</span> <span class="o">=</span> <span class="p">[[</span><span class="n">WXSDKInstance</span> <span class="n">alloc</span><span class="p">]</span><span class="n">init</span><span class="p">];</span>
    <span class="n">_instance</span><span class="p">.</span><span class="n">viewController</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
    <span class="n">_instance</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">bounds</span><span class="p">;</span>
    
    <span class="k">__weak</span> <span class="k">typeof</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span> <span class="n">weakSelf</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
    <span class="n">_instance</span><span class="p">.</span><span class="n">onCreate</span> <span class="o">=</span> <span class="o">^</span><span class="p">(</span><span class="n">UIView</span> <span class="o">*</span><span class="n">view</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">weakSelf</span><span class="p">.</span><span class="n">weexView</span> <span class="n">removeFromSuperview</span><span class="p">];</span>
        <span class="n">weakSelf</span><span class="p">.</span><span class="n">weexView</span> <span class="o">=</span> <span class="n">view</span><span class="p">;</span>
        <span class="p">[</span><span class="n">weakSelf</span><span class="p">.</span><span class="n">view</span> <span class="nl">addSubview</span><span class="p">:</span><span class="n">weakSelf</span><span class="p">.</span><span class="n">weexView</span><span class="p">];</span>
    <span class="p">};</span>
    
    <span class="n">_instance</span><span class="p">.</span><span class="n">onFailed</span> <span class="o">=</span> <span class="o">^</span><span class="p">(</span><span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//process failure
</span><span class="c1"></span>    <span class="p">};</span>
    
    <span class="n">_instance</span><span class="p">.</span><span class="n">renderFinish</span> <span class="o">=</span> <span class="o">^</span> <span class="p">(</span><span class="n">UIView</span> <span class="o">*</span><span class="n">view</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//process renderFinish
</span><span class="c1"></span>    <span class="p">};</span>
    <span class="p">;</span>
    
<span class="c1">//    NSLog(@&#34;mainBundlePath = %@&#34;,);
</span><span class="c1">//
</span><span class="c1">//    NSString *path = [NSString stringWithFormat:@&#34;file://%@/dist/%@&#34;,[NSBundle mainBundle].bundlePath,@&#34;index.js&#34;];
</span><span class="c1"></span>    
    <span class="p">[</span><span class="n">_instance</span> <span class="nl">renderWithURL</span><span class="p">:[[</span><span class="n">NSBundle</span> <span class="n">mainBundle</span><span class="p">]</span><span class="nl">URLForResource</span><span class="p">:</span><span class="s">@&#34;index&#34;</span> <span class="nl">withExtension</span><span class="p">:</span><span class="s">@&#34;js&#34;</span><span class="p">]];</span>
<span class="p">}</span>
</code></pre></div><ul>
<li>5.运行即可。</li>
</ul>
<h2 id="四-坑点">四. 坑点</h2>
<h4 id="41-版本不对应">4.1 版本不对应</h4>
<p>主要问题就是weex官网的版本和github的版本不对应，刚开始我用的0.9的版本，发现怎么跑跑不起来。最后去官网下载了demo，在demo中搜索WX_SDK_VERSION 看到weexsdk都更新到0.18.0了。发现之后，更新版本，开开心心运行程序。</p>
<h4 id="42-加载不出来数据">4.2 加载不出来数据</h4>
<p>数据是从接口拿的，需要配置一下info.plist的ATS。复制以下代码到info.plist即可</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;
	&lt;dict&gt;
		&lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;
		&lt;true/&gt;
	&lt;/dict&gt;
</code></pre></div><h2 id="五-感受">五. 感受</h2>
<p>具体还没开始使用，只是搭建环境和运行真机，譬如hot reload、webpack、weex-loader等等都还没有开始搞。主要有一下几点想说。
缺点：</p>
<ul>
<li>1.官方文档的更新不及时，而且比较草率。对于新接触weex的程序员不友好。无法很快上手。</li>
<li>2.网络上的资料太少，过于陈旧，找一找全都是2016年7月份 - 2017年的技术帖。</li>
<li>3.看到weex支持vue.js和Rax框架，但是貌似只发现了Vue.js的支持，没有发现Rax的支持。</li>
<li>4.社区太不活跃，出了问题都不知道去问谁。这大大提高了weex学习的成本。</li>
</ul>
<p>优点：暂时没有使用，无法评判。</p>
<p>真害怕，某天weex又像Ali的其他开源项目一样烂尾。但还是希望Ali团队的愿景可以得以实现。</p></div>
        <div class="post-footer">
            <div class="info">
                <span class="separator"><a class="category" href="/categories/weex/">weex</a><a class="category" href="/categories/cross-platform/">cross-platform</a></span>
                
            </div>
        </div>

        <div id="fb_comments_container">
                <h2>comments</h2>
                <script src="https://utteranc.es/client.js" 
        repo="fuCking-Life/fuCking-Life.github.io"
        issue-term="pathname"
        theme="github-light" 
        
        crossorigin="anonymous" 
        async>
</script>
            </div>
    </div>


        </div>
    </div>
</div>

<script type="text/javascript"
        src="/js/medium-zoom.min.2d6fd0be87fa98f0c9b4dc2536b312bbca48757f584f6ea1f394abc9bcc38fbc.js"
        integrity="sha256-LW/Qvof6mPDJtNwlNrMSu8pIdX9YT26h85SrybzDj7w="
        crossorigin="anonymous"></script></body>

</html>
